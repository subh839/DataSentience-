<div class="container mx-auto p-6 max-w-6xl">
    <!-- Header -->
    <div class="text-center mb-8">
      <h1 class="text-4xl font-bold text-gray-800 mb-2">DataSentience AI Analyzer</h1>
      <p class="text-lg text-gray-600">Predictive maintenance and cost optimization for data centers</p>
    </div>
  
    <!-- Query Input Card -->
    <div class="bg-white shadow-lg rounded-lg p-6 mb-6">
      <h2 class="text-xl font-semibold mb-4">Analyze Data Center Issues</h2>
      
      <textarea
        [(ngModel)]="query"
        placeholder="Ask about data center issues, e.g., 'What is causing the temperature spikes?' or 'Predict potential failures in cooling system'"
        rows="4"
        class="w-full p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent mb-4"
      ></textarea>
      
      <button 
        (click)="analyze()" 
        [disabled]="isLoading() || !query.trim()"
        class="w-full bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 disabled:bg-gray-400 flex items-center justify-center"
      >
        @if (isLoading()) {
          <span>Analyzing...</span>
        } @else {
          <span>Analyze</span>
        }
      </button>
    </div>
  
    <!-- Error Message -->
    @if (error()) {
      <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6">
        {{ error() }}
      </div>
    }
  
    <!-- Results -->
    @if (result(); as resultData) {
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <!-- Analysis Results -->
        <div class="bg-white shadow-lg rounded-lg p-6">
          <h2 class="text-xl font-semibold mb-4 text-blue-600">Analysis Results</h2>
          
          <!-- Severity -->
          <div class="mb-4">
            <div class="flex items-center justify-between">
              <span class="font-medium">Severity Level:</span>
              <span [class]="getSeverityBadgeColor(resultData.analysis.severity) + ' px-3 py-1 rounded-full text-sm font-medium'">
                {{ resultData.analysis.severity }}
              </span>
            </div>
          </div>
  
          <!-- Confidence Score -->
          <div class="mb-4">
            <div class="flex items-center justify-between">
              <span class="font-medium">Confidence Score:</span>
              <span class="text-lg font-semibold text-blue-600">
                {{ (resultData.analysis.confidence_score * 100).toFixed(1) }}%
              </span>
            </div>
          </div>
  
          <!-- Root Causes -->
          <div class="mb-4">
            <h3 class="font-medium mb-2 text-gray-700">Root Causes:</h3>
            <ul class="list-disc list-inside space-y-1">
              @for (cause of resultData.analysis.root_causes; track cause) {
                <li class="text-gray-600">{{ cause }}</li>
              }
            </ul>
          </div>
  
          <!-- Affected Systems -->
          <div>
            <h3 class="font-medium mb-2 text-gray-700">Affected Systems:</h3>
            <div class="flex flex-wrap gap-2">
              @for (system of resultData.analysis.affected_systems; track system) {
                <span class="bg-gray-100 px-3 py-1 rounded-full text-sm">{{ system }}</span>
              }
            </div>
          </div>
        </div>
  
        <!-- Action Plan -->
        <div class="bg-white shadow-lg rounded-lg p-6">
          <h2 class="text-xl font-semibold mb-4 text-green-600">Action Plan</h2>
          
          <!-- Cost Savings -->
          @if (resultData.action_plan.estimated_cost_savings) {
            <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-4">
              <h3 class="font-semibold text-green-800">Estimated Cost Savings</h3>
              <p class="text-2xl font-bold text-green-600">
                ${{ resultData.action_plan.estimated_cost_savings.toLocaleString() }}
              </p>
            </div>
          }
  
          <!-- Immediate Actions -->
          <div class="mb-4">
            <h3 class="font-medium mb-2 text-gray-700">Immediate Actions (Next 24 hours):</h3>
            <ul class="list-disc list-inside space-y-1">
              @for (action of resultData.action_plan.immediate_actions; track action) {
                <li class="text-gray-600">{{ action }}</li>
              }
            </ul>
          </div>
  
          <!-- Short-term Solutions -->
          <div class="mb-4">
            <h3 class="font-medium mb-2 text-gray-700">Short-term Solutions (1-4 weeks):</h3>
            <ul class="list-disc list-inside space-y-1">
              @for (solution of resultData.action_plan.short_term_solutions; track solution) {
                <li class="text-gray-600">{{ solution }}</li>
              }
            </ul>
          </div>
  
          <!-- Long-term Recommendations -->
          <div>
            <h3 class="font-medium mb-2 text-gray-700">Long-term Recommendations (1-6 months):</h3>
            <ul class="list-disc list-inside space-y-1">
              @for (recommendation of resultData.action_plan.long_term_recommendations; track recommendation) {
                <li class="text-gray-600">{{ recommendation }}</li>
              }
            </ul>
          </div>
        </div>
      </div>
    }
  </div>